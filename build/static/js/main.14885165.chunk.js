(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{22:function(e,t,a){},23:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},49:function(e,t,a){e.exports=a.p+"static/media/loader.9a2c42ba.gif"},52:function(e,t,a){e.exports=a(91)},57:function(e,t,a){},80:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){},91:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),i=a(24),l=a.n(i),o=(a(57),a(50)),s=a(1),d=a(4),m=a(3),u=a(2),p=a(7),h=a(14),v=a(16),_=a(47),f=a(30),y=function e(){Object(s.a)(this,e),this.id=-1,this.created_at=void 0},g={loggedIn:!1,user:new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).email=void 0,e}return a}(y)),operator_token:""};!function(e){e[e.LOGIN=0]="LOGIN",e[e.LOGOUT=1]="LOGOUT"}(n||(n={}));var b=Object(h.c)({authReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.LOGIN:return e.user=t.user,e.operator_token=t.operator_token,e.loggedIn=!0,Object(f.a)({},e);case n.LOGOUT:return e.loggedIn=!1,window.localStorage.removeItem("access_token"),window.localStorage.removeItem("refresh_token"),Object(f.a)({},e)}return e}}),E=Object(h.d)(b,Object(h.a)(_.a)),w=function(e,t){return function(a){a(function(e,t){return{type:n.LOGIN,user:e,operator_token:t}}(e,t))}},N=function(){return function(e){e({type:n.LOGOUT})}},O={API_URL:"",OPERATOR_TOKEN:"8500f3e1-0282-4d09-a752-6756d188f584"},D=a(18),j=a.n(D),k=a(26),S=a(48),I=a.n(S).a.create({baseURL:O.API_URL,timeout:0,headers:{Authorization:"JWT "+window.localStorage.getItem("access_token"),"Content-Type":"application/json",accept:"application/json","operator-token":window.localStorage.getItem("operator_token")}});I.interceptors.response.use((function(e){return e}),function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.config,401!==t.response.status){e.next=17;break}return n=window.localStorage.getItem("refresh_token"),e.prev=3,e.next=6,I.post("/core/auth/token/refresh/",{refresh:n});case 6:return r=e.sent,window.localStorage.setItem("access_token",r.data.access),window.localStorage.setItem("refresh_token",r.data.refresh),I.defaults.headers.Authorization="JWT "+r.data.access,a.headers.Authorization="JWT "+r.data.access,e.abrupt("return",I(a));case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0);case 17:return e.abrupt("return",Promise.reject(t));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}());var C,x=I,M=function(){function e(){Object(s.a)(this,e),this._service_url=O.API_URL,this.appName="",this.view=""}return Object(d.a)(e,[{key:"_get",value:function(e){var t=this;return new Promise((function(a,n){x.get("".concat(t._service_url,"/").concat(e)).then((function(e){a(e.data)})).catch((function(e){return n(e)}))}))}},{key:"_post",value:function(e,t,a){var n=this;return new Promise((function(r,c){x.post("".concat(n._service_url,"/").concat(e),t,a).then((function(e){r(e.data)})).catch((function(e){return c(e)}))}))}},{key:"_patch",value:function(e,t,a){var n=this;return new Promise((function(r,c){x.patch("".concat(n._service_url,"/").concat(e),t,a).then((function(e){r(e.data)})).catch((function(e){return c(e)}))}))}},{key:"_delete",value:function(e){return x.delete("".concat(this._service_url,"/").concat(e))}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?this.multipartFormPost(e):this._post("".concat(this.appName,"/").concat(this.view,"/"),e)}},{key:"delete",value:function(e){return this._delete("".concat(this.appName,"/").concat(this.view,"/").concat(e,"/"))}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==e?this._get("".concat(this.appName,"/").concat(this.view,"/").concat(e,"/").concat(this.querizeObject(t))):this._get("".concat(this.appName,"/").concat(this.view,"/?").concat(this.querizeObject(t)))}},{key:"getByDate",value:function(e){return this._get("".concat(this.appName,"/").concat(this.view,"/get_by_date/?date=").concat(e))}},{key:"getByDateRange",value:function(e,t){var a="".concat(this.appName,"/").concat(this.view,"/get_by_date_range/?");return e&&(a+="start_date=".concat(e,"&")),t&&(a+="end_date=".concat(t)),this._get(a)}},{key:"multipartFormPost",value:function(e){var t=new FormData;return Object.keys(e).forEach((function(a){t.append(a,e[a])})),console.log(t),this._post("".concat(this.appName,"/").concat(this.view,"/"),t,{headers:{"Content-Type":"multipart/form-data"}})}},{key:"multipartFormUpdate",value:function(e,t){var a=new FormData;return Object.keys(t).forEach((function(e){a.append(e,t[e])})),console.log(a),this._patch("".concat(this.appName,"/").concat(this.view,"/").concat(e,"/"),a,{headers:{"Content-Type":"multipart/form-data"}})}},{key:"search",value:function(e){return this._get("".concat(this.appName,"/").concat(this.view,"/?search=").concat(e))}},{key:"querizeObject",value:function(e){return Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")}},{key:"softDelete",value:function(e){return this._get("".concat(this.appName,"/").concat(this.view,"/soft_delete/").concat(e,"/"))}},{key:"update",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a?this.multipartFormUpdate(e,t):this._patch("".concat(this.appName,"/").concat(this.view,"/").concat(e,"/"),t)}},{key:"viewPath",get:function(){return"".concat(this.appName,"/").concat(this.view)}}]),e}(),A=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="core",e.view="auth",e.authenticate=function(t,a){return e.logout(),new Promise((function(n,r){e._post("".concat(e.viewPath,"/authenticate/"),{email:t,password:a}).then((function(e){console.log(e),null!==e.operator_token?(window.localStorage.setItem("access_token",e.access),window.localStorage.setItem("refresh_token",e.refresh),window.localStorage.setItem("operator_token",e.operator_token),n(e)):r(e)})).catch((function(e){return r(e)}))}))},e.logout=function(){window.localStorage.removeItem("access_token"),window.localStorage.removeItem("refresh_token"),window.localStorage.removeItem("user_id"),window.localStorage.removeItem("username")},e.validateToken=function(t){return new Promise((function(t,a){e._get("".concat(e.viewPath,"/user")).then((function(e){t(e)})).catch((function(e){return a(e)}))}))},e}return a}(M)),T=(a(80),a(5)),U=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={doLogin:!1},e.logout=function(){e.props.logout()},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return this.state.doLogin?c.a.createElement(p.a,{to:"/dashboard/login"}):c.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},c.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},c.a.createElement("span",{className:"navbar-toggler-icon"})),c.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},c.a.createElement("ul",{className:"navbar-nav mr-auto"},c.a.createElement("li",{className:"nav-item active"},c.a.createElement(T.b,{className:"nav-link",to:"/dashboard/browser"},"Home")),c.a.createElement("li",{className:"nav-item active"},c.a.createElement(T.b,{className:"nav-link",to:"/dashboard/menu/en"},"Menu")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(T.b,{className:"nav-link",to:"/dashboard/deliveries"},"Delivery Days")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(T.b,{className:"nav-link",to:"/dashboard/delivery_window"},"Delivery Windows")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(T.b,{className:"nav-link",to:"/dashboard/coupons"},"Coupons")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(T.b,{className:"nav-link",to:"/dashboard/mail"},"Mail")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(T.b,{className:"nav-link",to:"/dashboard/newsletter"},"Newsletters")),c.a.createElement("li",{className:"nav-item"},c.a.createElement(T.b,{className:"nav-link",to:"/dashboard/orders"},"Orders")))),c.a.createElement("span",{className:"navbar-text"},this.props.auth.loggedIn?c.a.createElement("button",{className:"btn btn-danger",onClick:this.logout},"Logout"):c.a.createElement("div",{className:"btn btn-success",onClick:function(){return e.setState({doLogin:!0})}},"Login")))}}]),a}(c.a.Component),L=Object(v.b)((function(e){return{auth:e.authReducer}}),(function(e){return{logout:Object(h.b)(N,e)}}))(U),F=a(9),P=a(92),R=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="delivery_day",e.attachDeliveryWindow=function(t,a){return e._get("".concat(e.appName,"/").concat(e.view,"/attach_delivery_window/").concat(t.id,"/").concat(a.id,"/"))},e.detachDeliveryWindow=function(t,a){return e._get("".concat(e.appName,"/").concat(e.view,"/detach_delivery_window/").concat(t.id,"/").concat(a.id,"/"))},e.duplicateDeliveryDay=function(t,a,n){return e._get("".concat(e.appName,"/").concat(e.view,"/duplicate/?date=").concat(a,"&end_date=").concat(n,"&delivery_day=").concat(t.id))},e}return Object(d.a)(a,[{key:"attachWeekMenuItem",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return console.log(e,t),this._get("".concat(this.appName,"/").concat(this.view,"/attach_week_menu_item?week=").concat(e,"/").concat(t,"/").concat(!0===a?"1":"0"))}}]),a}(M)),B=(a(22),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,c){var i;return Object(s.a)(this,a),(i=t.call(this)).date=void 0,i.end_date=void 0,i.day_items=void 0,i.id=n||-1,i.date=e||"",i.end_date=r||"",i.day_items=c||[],i}return a}(y)),V=a(21),W=new(function(){function e(){var t=this;Object(s.a)(this,e),this.days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.spicy=["not spicy","mild spicy","spicy"],this.proteins={pork:"Pork",chicken:"Chicken",beef:" Beef",tofu:" Tofu",veg:"Vegetable",vekan:"Vegan",shrimp:"Shrimp"},this.dateToShortISO=function(e){return e.toISOString().slice(0,10)},this.extractCartItemDescription=function(e){var a=e.menu_item.name;return a+=null===e.protein||""===e.protein||e.menu_item.proteins.split(":").length<2?"":"vekan"===e.protein?" vegan":" with ".concat(t.proteins[e.protein]),a+=!0===e.menu_item.spicy?", ".concat(t.spicy[e.spicy]):""},this.formatDate=function(e){-1===e.indexOf("T")&&(e+="T16:57:53.762237-07:00");var a=new Date(e);return"".concat(t.days[a.getDay()]," ").concat(t.months[a.getMonth()]," ").concat(a.getDate(),", ").concat(a.getFullYear())},this.sortOrderItemsByDate=function(e){var t={};return e.forEach((function(e){e.cart_item.delivery_date in t||(t[e.cart_item.delivery_date]=[]),t[e.cart_item.delivery_date].push(e)})),t},this.sortDeliveryDayItemsByCategory=function(e){var t={en:[],ap:[],si:[],de:[]};return e&&e.forEach((function(e){return t[e.menu_item.category].push(e)})),[].concat(Object(V.a)(t.en),Object(V.a)(t.ap),Object(V.a)(t.si),Object(V.a)(t.de))},this.groupMenuItemsByCategory=function(e){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={en:[],ap:[],si:[],de:[]};return e.forEach((function(e){return n[e.category].push(e)})),a&&n.en.sort(t.compareMenuItemsByName),n}}return Object(d.a)(e,[{key:"compareMenuItemsByName",value:function(e,t){return e.name<t.name?-1:t.name<e.name?1:0}}]),e}()),z=function(e){var t=Object(p.g)();return c.a.createElement("div",{className:"row delivery_days",key:"days_".concat(e.deliveryDay.id)},c.a.createElement("div",{className:"col-12 col-md-6 delivery_days__date"},W.formatDate(e.deliveryDay.date)),c.a.createElement("div",{className:"col-12 col-md-6 delivery_days__end_date"},W.formatDate(e.deliveryDay.end_date)),c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{className:"row"},W.sortDeliveryDayItemsByCategory(e.deliveryDay.day_items).map((function(e){return c.a.createElement("div",{className:"col-4 delivery_days_item",key:"ddi_".concat(e.id)},c.a.createElement("small",null,e.menu_item.name),c.a.createElement("div",null,c.a.createElement("img",{src:"".concat(O.API_URL+e.menu_item.image),alt:e.menu_item.name})))})))),c.a.createElement("div",{className:"col-12 text-center mt-3"},c.a.createElement("button",{className:"btn btn-success",onClick:function(){t.push({pathname:"/dashboard/delivery/edit/".concat(e.deliveryDay.id,"/")})}},"Edit"),c.a.createElement("button",{className:"btn btn-warning ml-2",onClick:function(){t.push({pathname:"/dashboard/delivery/duplicate/".concat(e.deliveryDay.id)})}},"Duplicate")))},q=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loaded:!1,deliveryDays:[],startDate:"",endDate:"",creatingDeliveryDay:!1,editId:0},e.componentDidMount=function(){R.get(null,{start_date:Object(P.a)(new Date,"yyyy-MM-dd")}).then((function(t){return e.setState({deliveryDays:t,loaded:!0})})).catch((function(e){return window.alert("Unable to load weeks")}))},e.createDeliveryDay=function(){e.state.startDate>e.state.endDate?window.alert("End date must be after start date"):(e.setState({creatingDeliveryDay:!0}),R.add(new B(e.state.startDate,-1,e.state.endDate)).then((function(t){e.setState({editId:t.id,startDate:"",creatingDeliveryDay:!1})})).catch((function(e){return window.alert("Unable to create week")})))},e.updateData=function(t){e.setState(Object(F.a)({},t.target.id,t.target.value))},e}return Object(d.a)(a,[{key:"render",value:function(){if(!this.state.loaded)return c.a.createElement("div",null,"Loading...");if(0!==this.state.editId)return c.a.createElement(p.a,{to:"delivery/edit/".concat(this.state.editId)});var e=this.state.deliveryDays;return e.sort((function(e,t){return e.date>t.date?-1:t.date>e.date?1:0})),c.a.createElement("div",{className:"row weeks"},c.a.createElement("div",{className:"col-12"},c.a.createElement("h5",null,"Add A Delivery Menu:"),c.a.createElement("input",{type:"date",id:"startDate",value:this.state.startDate,disabled:this.state.creatingDeliveryDay,onChange:this.updateData}),c.a.createElement("input",{type:"date",id:"endDate",value:this.state.endDate,disabled:this.state.creatingDeliveryDay,onChange:this.updateData}),c.a.createElement("button",{className:"btn btn-success ml-2",onClick:this.createDeliveryDay,disabled:this.state.creatingDeliveryDay},"Add"),c.a.createElement("hr",null)),e.map((function(e){return c.a.createElement("div",{className:"col-12 col-md-6 deliveries__delivery_days",key:"dd_".concat(e.id)},c.a.createElement(z,{deliveryDay:e,key:"dd_".concat(e.id)}))})))}}]),a}(c.a.Component),J=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="menu_item",e.loadByCategory=function(t){return e._get("".concat(e.appName,"/").concat(e.view,"/?category=").concat(t))},e}return a}(M)),G=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="delivery_day_item",e}return a}(M)),K=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).timer=void 0,n.lastSavedValue=null,n.componentWillReceiveProps=function(e){e.initialValue!==n.props.initialValue&&(n.setState({value:e.initialValue}),n.lastSavedValue=e.initialValue)},n.handleOnKeyPress=function(e){13===e.keyCode&&n.sendUpdate()},n.updateValue=function(e){n.setState({value:e.target.value}),n.resetTimer()},n.sendUpdate=function(){if(n.props.initialValue!==n.state.value){n.lastSavedValue=n.state.value;var e=""!==n.props.defaultUpdateValue&&""===n.props.initialValue?n.props.defaultUpdateValue:n.state.value;n.props.onUpdate(n.props.id,e),clearInterval(n.timer)}},n.resetTimer=function(){clearTimeout(n.timer),n.timer=setTimeout(n.sendUpdate,750)},n.state={value:e.initialValue?e.initialValue:""},n.lastSavedValue=e.initialValue,n}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return"textarea"===this.props.type?c.a.createElement("div",{className:"row input_widget_textarea"},c.a.createElement("div",{className:"col-12"},c.a.createElement("textarea",{className:"form-control iw",id:this.props.id,value:this.state.value,onBlur:function(){return e.sendUpdate()},onChange:function(t){return e.updateValue(t)},onKeyDown:function(t){return e.handleOnKeyPress(t)},required:!!this.props.required&&this.props.required}))):c.a.createElement("div",{className:"row input_widget_input"},c.a.createElement("div",{className:"col-12"},c.a.createElement("input",{className:"form-control iw",id:this.props.id,placeholder:this.props.placeholder,value:this.state.value,onBlur:function(){return e.sendUpdate()},onChange:function(t){return e.updateValue(t)},onKeyDown:function(t){return e.handleOnKeyPress(t)}})))}}]),a}(r.Component),Y=(a(82),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){window.onclick=function(e){this.close()}},n.itemSelected=function(e){n.setState({items:[]}),n.props.itemSelected(e)},n.doSearch=function(e,t){n.props.service.search(t).then((function(e){return n.setState({items:e})})).catch((function(e){}))},n.state={items:[]},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"row search_widget"},c.a.createElement("div",{className:"col-12"},c.a.createElement(K,{id:"search_widget__InputWidget",type:"",initialValue:"",onUpdate:this.doSearch,placeholder:"Enter Menu Item to Add",defaultUpdateValue:""})),this.state.items.length>0&&c.a.createElement("div",{className:"col-12 search_widget_results"},c.a.createElement("div",{className:"search_widget_results__content"},this.state.items.map((function(t){return c.a.createElement("div",{className:"row result",onClick:function(){return e.itemSelected(t)}},c.a.createElement("div",{className:"col-9 result__name"},t.name),c.a.createElement("div",{className:"col-3"},c.a.createElement("img",{src:O.API_URL+t.image,alt:t.name})))})))))}}]),a}(c.a.Component)),H=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"en",c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Object(s.a)(this,e),this.id=void 0,this.name="",this.description="",this.proteins="",this.allergens="",this.price=0,this.image="",this.active=void 0,this.spicy=void 0,this.category="en",this.id=t,this.name=a,this.description=n,this.category=r,this.price=c,this.proteins=i,this.allergens=l,this.spicy=o},X=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,c){var i;return Object(s.a)(this,a),(i=t.call(this)).sold_out=!1,i.price=0,i.menu_item=void 0,i.delivery_day=void 0,i.delivery_day=e,i.menu_item=n,i.sold_out=r,i.price=c,i}return a}(y),$=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,c){var i;return Object(s.a)(this,a),(i=t.call(this)).sold_out=!1,i.price=0,i.menu_item=void 0,i.delivery_day=void 0,i.getDTOxxx=function(){return new X(i.delivery_day.id,i.menu_item.id,i.sold_out,i.price)},i.delivery_day=e||new B,i.menu_item=n||new H,i.sold_out=r||!1,i.price=c||0,i}return a}(y),Z=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).remove=function(){window.confirm("Are you sure you want to remove this menu item?")&&(n.setState({saving:!0}),G.delete(n.state.deliveryDayItem.id).then((function(e){return n.setState({deliveryDayItem:new $(n.state.deliveryDayItem.delivery_day,n.state.deliveryDayItem.menu_item,!1,0),active:!1,saving:!1},(function(){return n.props.refreshItems()}))})).catch((function(e){return window.alert("Unable to deactivate")})))},n.save=function(){n.setState({saving:!0}),G.update(n.state.deliveryDayItem.id,n.state.deliveryDayItem).then((function(e){return n.setState({deliveryDayItem:e,saving:!1})})).catch((function(e){return window.alert("Unable to update")}))},n.updateData=function(e){var t=n.state.deliveryDayItem;switch(e.target.id){case"active":n.setState({active:!n.state.active});break;case"sold_out":t.sold_out=!t.sold_out;break;case"price":t.price=parseFloat(e.target.value)}n.setState({deliveryDayItem:t})},n.state={deliveryDayItem:e.deliveryDayItem,saving:!1,active:!!e.deliveryDayItem.id},n}return Object(d.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"row delivery_item_options"},c.a.createElement("div",{className:"col-12"},c.a.createElement("hr",null)),c.a.createElement("div",{className:"col-4"},c.a.createElement("input",{type:"number",id:"price",value:this.state.deliveryDayItem.price,onChange:this.updateData,disabled:this.state.saving||!this.state.active,className:"form-control delivery_item_options__price"})),c.a.createElement("div",{className:" col-8 mt-3"},c.a.createElement("span",{className:"mr-2"},"Sold Out:"),c.a.createElement("input",{id:"sold_out",checked:this.state.deliveryDayItem.sold_out,onChange:this.updateData,disabled:this.state.saving||!this.state.active,type:"checkbox"})),c.a.createElement("div",{className:"col-12 text-center mt-3"},c.a.createElement("button",{className:"btn btn-success",disabled:this.state.saving||!this.state.active,onClick:this.save},"Save"),c.a.createElement("button",{className:"btn btn-danger ml-3",disabled:this.state.saving,onClick:this.remove},"Remove")))}}]),a}(c.a.Component),Q=function(e){return c.a.createElement("div",{className:"row delivery_day_item"},c.a.createElement("div",{className:"col-12 delivery_day_item__name"},e.item.menu_item.name),c.a.createElement("div",{className:"col-12"},c.a.createElement("img",{className:"delivery_day_item__img",src:-1===e.item.menu_item.image.indexOf("http")?O.API_URL+e.item.menu_item.image:e.item.menu_item.image,alt:e.item.menu_item.name})),c.a.createElement("div",{className:"col-12"},c.a.createElement(Z,{deliveryDayItem:e.item,refreshItems:Object(k.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.refreshItems());case 1:case"end":return t.stop()}}),t)})))})))},ee=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,menuItems:[],deliveryDay:new B(""),deliveryWindows:[]},e.componentDidMount=function(){var t=e.props.match.params;e.refreshDay(t.id)},e.itemSelected=function(t){G.add(new X(e.state.deliveryDay.id,t.id,!1,t.price)).then((function(t){var a=e.state.deliveryDay;a.day_items.push(t),e.setState({deliveryDay:a}),console.log(a)})).catch((function(e){return window.alert("unable to add menu item")}))},e.refreshDay=function(t){R.get(t).then((function(t){e.setState({deliveryDay:t,loading:!1})})).catch((function(e){return window.alert("Unable to load week")}))},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return this.state.loading?c.a.createElement("div",null,"Loading..."):c.a.createElement("div",{className:"row delivery_day_component"},c.a.createElement("div",{className:"col-12 col-md-6"},W.formatDate(this.state.deliveryDay.date)," - ",W.formatDate(this.state.deliveryDay.end_date),c.a.createElement("hr",null)),c.a.createElement("div",{className:"col-12 col-md-6 delivery_day_component__search_widget"},c.a.createElement(Y,{service:J,itemSelected:this.itemSelected})),this.state.deliveryDay.day_items.map((function(t){return c.a.createElement("div",{className:"col-12 col-md-3",key:"dd_".concat(t.id)},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement(Q,{item:t,refreshItems:function(){return e.refreshDay(e.state.deliveryDay.id)}}))))})))}}]),a}(c.a.Component),te=a(8);!function(e){e[e.menu=0]="menu",e[e.deliveryDay=1]="deliveryDay"}(C||(C={}));var ae,ne=function(){var e=Object(p.h)(),t=Object(r.useState)([]),a=Object(te.a)(t,2),n=a[0],i=a[1];Object(r.useEffect)((function(){return J.loadByCategory(e.category).then((function(e){i(e)})).catch((function(e){window.alert("Unable To Load Menu Items")})),function(){}}),[e.category]);var l=n.sort((function(e,t){return e.name>t.name?1:-1}));return c.a.createElement("div",{className:"row menu_items mt-3"},l.sort((function(e,t){return e.name.toLowerCase()>t.name.toLowerCase()?1:e.name.toLowerCase()<t.name.toLowerCase()?-1:0})).map((function(e){return c.a.createElement("div",{className:"col-12 col-md-3 menu_items__item",key:"mi_".concat(e.id)},c.a.createElement(T.b,{className:"row",to:"/dashboard/menu/edit/".concat(e.id,"/")},c.a.createElement("div",{className:"col-12 item__item_name"},e.name),c.a.createElement("div",{className:"col-12 item__item_image"},c.a.createElement("img",{src:O.API_URL+e.image,alt:e.name}))))})))},re=(a(83),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).fileElement=null,n.reloadAttempted=!0,n.componentDidMount=function(){n.props.imageURL&&n.loadImage(n.props.imageURL)},n.componentDidUpdate=function(e){},n.clearImage=function(e){n.props.disabled||(e.preventDefault(),n.setState({hasImage:!1}),n.props.newImageLoaded(null))},n.loadImage=function(e){n.toDataURL(e).then((function(e){window.document.getElementById(n.props.id).src=e,n.setState({loadingImage:!1})})).catch((function(t){window.setTimeout((function(){n.reloadAttempted?n.setState({loadingImage:!1,hasImage:!1}):(n.reloadAttempted=!0,n.loadImage(e))}),3e3)}))},n.onInputChanged=function(e){e.target.files&&e.target.files[0]&&n.readFile(e.target.files[0]).then((function(e){console.log(e.file.size);var t=n.props.maximumSizeInMb?n.props.maximumSizeInMb:2;e.file.size>1048576*t?window.alert("Maximum File Size is ".concat(t,"Mb")):(window.document.getElementById(n.props.id).src=e.result,n.setState({currentImage:e.dataURL,hasImage:!0}),n.props.newImageLoaded(e.file))}))},n.open=function(){var e;n.props.disabled||null===(e=n.fileElement)||void 0===e||e.click()},n.readFile=function(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(a){var n=a.target.result;n=n.replace(";base64",";name=".concat(e.name,";base64")),t({file:e,dataURL:n,result:a.target.result})},n.readAsDataURL(e)}))},n.state={hasImage:""!==e.imageURL&&null!==e.imageURL,currentImage:null,loadingImage:""!==e.imageURL&&null!==e.imageURL},n}return Object(d.a)(a,[{key:"toDataURL",value:function(e){return new Promise((function(t,a){var n=new XMLHttpRequest;n.onload=function(){if("text/html"!==n.response.type){var e=new FileReader;e.onloadend=function(){var a;t(null===(a=e.result)||void 0===a?void 0:a.toString())},e.readAsDataURL(n.response)}else a()},n.open("GET",e),n.responseType="blob",n.send()}))}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"image_uploader ".concat(this.props.disabled?"":"image_uploader--active")},c.a.createElement("div",{className:"inner",onClick:this.open},c.a.createElement("img",{src:"",alt:"question",id:this.props.id,className:this.state.hasImage?"":"hidden"}),c.a.createElement("input",{type:"file",id:"xxx",ref:function(t){return e.fileElement=t},onChange:this.onInputChanged,accept:this.props.allowedFileTypes?this.props.allowedFileTypes:""}),!this.state.hasImage&&!this.props.disabled&&c.a.createElement("div",{className:"no-image image_uploader-overlay"},c.a.createElement("span",null,this.props.uploadPrompt||"Click to  Upload Image"))),this.state.hasImage&&!this.props.disabled&&c.a.createElement("div",{className:"remove-btn",onClick:this.clearImage},"X"),this.state.loadingImage&&c.a.createElement("div",{className:"loading-image image_uploader-overlay"},c.a.createElement("span",null,"Loading Image...")))}}]),a}(c.a.Component)),ce=(a(84),a(49)),ie=a.n(ce),le=(a(85),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"loading-overlay"},c.a.createElement("img",{src:ie.a,alt:"loadingIcon"}))}}]),a}(c.a.Component));!function(e){e[e.add=0]="add",e[e.edit=1]="edit",e[e.view=2]="view",e[e.deliveryDay=3]="deliveryDay"}(ae||(ae={}));var oe=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).temporaryImage=null,e.state={menuItem:new H,loaded:!1,saving:!1,viewingServings:!1,hasBeenUpdated:!1},e.allergenSelected=function(t){var a=e.state.menuItem;a.allergens=e.checkboxesToString(a.allergens,t.target.id),e.setState({menuItem:a})},e.componentDidMount=function(){var t=e.props.match.params;J.get(t.id).then((function(t){e.setState({menuItem:t,loaded:!0})})).catch((function(e){return window.alert("Unable to load menu item")}))},e.checkboxesToString=function(e,t){null===e&&(e="");var a=e.split(":");console.log(a,e),-1!==a.indexOf(t)?a.splice(a.indexOf(t),1):a.push(t);var n=a.join(":");return":"===n.substr(0,1)?n.substr(1):n},e.onNewImageLoaded=function(t){if(e.temporaryImage=t,null===t){var a=e.state.menuItem;a.image=null,e.setState({menuItem:a})}e.setState({hasBeenUpdated:!0})},e.proteinSelected=function(t){var a=e.state.menuItem;a.proteins=e.checkboxesToString(a.proteins,t.target.id),e.setState({menuItem:a})},e.save=function(){e.setState({saving:!0});var t=e.state.menuItem;e.temporaryImage?t.image=e.temporaryImage:"string"===typeof t.image&&delete t.image,J.update(t.id,t,null!==t.image&&"string"!==typeof t.image).then((function(a){e.setState({menuItem:t,saving:!1,hasBeenUpdated:!1}),e.props.itemAdded&&e.props.itemAdded(a)}))},e.updateMenuItem=function(t){var a=e.state.menuItem;a[t.target.name]=t.target.value,e.setState({menuItem:a})},e.updateOptions=function(t){var a=e.state.menuItem;switch(t.target.id){case"spicy":a.spicy=!a.spicy,e.setState({menuItem:a});break;case"price":a.price=parseFloat(t.target.value),e.setState({menuItem:a})}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;if(!this.state.loaded)return c.a.createElement(le,null);var t=this.state.saving||this.props.mode===ae.view,a=this.props.mode===ae.view||this.props.mode===ae.deliveryDay;return c.a.createElement("div",{className:"row menuedititem mt-3"},c.a.createElement("div",{className:"col-12 col-md-6 menuedititem__header"}),c.a.createElement("div",{className:"col-12 menuedititem__inner p-3"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 menuedititem__imagearea menuedititem__area"},c.a.createElement(re,{id:"image_uploader__menuItem-".concat(this.state.menuItem.id),imageURL:this.state.menuItem.image,newImageLoaded:this.onNewImageLoaded,maximumSizeInMb:100,allowedFileTypes:".jpg,.png,.jpeg",disabled:a})))),c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 mt-1 mt-md-0"},c.a.createElement("input",{id:"menuedititem__name",type:"text",className:"form-control",placeholder:"Meal Name",name:"name",value:this.state.menuItem.name,onChange:this.updateMenuItem,disabled:a})),c.a.createElement("div",{className:"col-12 mt-1"},c.a.createElement("textarea",{className:"form-control",rows:2,placeholder:"Description",name:"description",value:this.state.menuItem.description,onChange:this.updateMenuItem,disabled:a})),c.a.createElement("div",{className:"col-12 mt-1"},"Category:",c.a.createElement("select",{name:"category",className:"form-control",defaultValue:this.state.menuItem.category,disabled:a,onChange:this.updateMenuItem},c.a.createElement("option",{value:"en"},"Entree"),c.a.createElement("option",{value:"ap"},"Apetizer"),c.a.createElement("option",{value:"si"},"Side Item"),c.a.createElement("option",{value:"de"},"Dessert"))),c.a.createElement("div",{className:"col-12 mt-1"},"Price:",c.a.createElement("input",{type:"text",name:"price",className:"form-control",value:this.state.menuItem.price,disabled:a,onChange:this.updateMenuItem})))),c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement("h3",null,"Allergens:"),[{name:"Milk",code:"milk"},{name:"Soy",code:"soy"},{name:"Shellfish",code:"shell"},{name:"Egg",code:"egg"},{name:"Fish",code:"fish"},{name:"Nuts",code:"nuts"},{name:"Peanuts",code:"peanut"},{name:"Wheat",code:"wheat"}].map((function(t){return e.props.mode===ae.deliveryDay?0===e.state.menuItem.allergens.length?c.a.createElement("div",{className:"checker-week",key:"allergens_".concat(t.code)},"\xa0"):-1!==e.state.menuItem.allergens.indexOf(t.code)?c.a.createElement("div",{className:"checker-week",key:"allergens_".concat(t.code)},t.name):null:c.a.createElement("div",{className:"menuedititem__checker",key:t.code},c.a.createElement("input",{type:"checkbox",id:t.code,checked:-1!==e.state.menuItem.allergens.indexOf(t.code),disabled:e.props.mode===ae.view,onChange:e.allergenSelected}),c.a.createElement("span",null,t.name))}))),c.a.createElement("div",{className:"col-12"},c.a.createElement("h3",null,"Proteins:"),[{name:"Pork",code:"pork"},{name:"Chicken",code:"chicken"},{name:"Beef",code:"beef"},{name:"Tofu",code:"tofu"},{name:"Veggie",code:"veg"},{name:"Vegan",code:"vekan"},{name:"Shrimp",code:"shrimp"}].map((function(t){return e.props.mode===ae.deliveryDay?0===e.state.menuItem.proteins.length?c.a.createElement("div",{className:"checker-week",key:"proteins_".concat(t.code)},"\xa0"):-1!==e.state.menuItem.proteins.indexOf(t.code)?c.a.createElement("div",{className:"checker-week",key:"proteins_".concat(t.code)},t.name):null:c.a.createElement("div",{className:"menuedititem__checker",key:t.code},c.a.createElement("input",{type:"checkbox",id:t.code,checked:e.state.menuItem.proteins.indexOf(t.code)>-1,disabled:e.props.mode===ae.view,onChange:e.proteinSelected}),c.a.createElement("span",null,t.name))}))),c.a.createElement("div",{className:"col-12"},this.props.mode===ae.deliveryDay?this.state.menuItem.spicy?c.a.createElement("div",{className:"menuedititem__checker_week"},"Spicy"):c.a.createElement("div",{className:"menuedititem__checker_week"},"Not Spicy"):c.a.createElement("div",{className:"menuedititem__checker"},c.a.createElement("input",{type:"checkbox",id:"spicy",checked:this.state.menuItem.spicy,disabled:this.props.mode===ae.view,onChange:this.updateOptions}),c.a.createElement("span",null,"Spicy"))))),c.a.createElement("div",{className:"col-12 menuedititem__controls_area menuedititem__area text-center mt-2"},c.a.createElement("hr",null),c.a.createElement("button",{className:"btn btn-success",disabled:t,onClick:this.save},"Save")))))}}]),a}(c.a.Component),se=(a(86),function(e){return c.a.createElement("div",{className:"col-12 subnav"},e.navItems.map((function(e){return c.a.createElement(T.b,{className:"subnav__item",to:e.link,key:e.title},e.title)})))}),de=(a(87),function(){var e=Object(r.useState)(""),t=Object(te.a)(e,2),a=t[0],n=t[1],i=Object(r.useState)("en"),l=Object(te.a)(i,2),o=l[0],s=l[1],d=Object(r.useState)(!1),m=Object(te.a)(d,2),u=m[0],h=m[1],v=Object(p.g)();return c.a.createElement("div",{className:"row new_menu_item mt-3"},!1===u?c.a.createElement("div",{className:"col-12 new_menu_item__add_link",onClick:function(){return h(!0)}},"+ Add New Item"):c.a.createElement(r.Fragment,null,c.a.createElement("div",{className:"col-12"},c.a.createElement("input",{type:"text",className:"form-control",id:"new_menu_item__name",value:a,placeholder:"New Menu Item Name",onChange:function(e){return n(e.target.value)}})),c.a.createElement("div",{className:"col-12 mt-1"},c.a.createElement("select",{className:"form-control",defaultValue:o,onChange:function(e){return s(e.target.value)}},c.a.createElement("option",{value:"en"},"Entree"),c.a.createElement("option",{value:"ap"},"Appetizer"),c.a.createElement("option",{value:"si"},"Side Item"),c.a.createElement("option",{value:"de"},"Dessert"))),c.a.createElement("div",{className:"col-12 mt-1 text-center"},c.a.createElement("button",{className:"btn btn-success new_menu_item__submit",disabled:""===a,onClick:function(){J.add({name:a,category:o}).then((function(e){v.push({pathname:"/dashboard/menu/edit/".concat(e.id,"/")}),n(""),s("en")})).catch((function(e){return window.alert("unable to add new menu item")}))}},"Add New Item"))))}),me=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){J.get().then((function(e){n.setState({menuItems:e,loaded:!0})})).catch((function(e){window.alert("Unable to load Menu Items: ".concat(e))}))},n.state={menuItems:[],loaded:!1},n}return Object(d.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement(se,{navItems:[{title:"Entrees",link:"/dashboard/menu/en"},{title:"Appitizers",link:"/dashboard/menu/ap"},{title:"Sides",link:"/dashboard/menu/si"},{title:"Desserts",link:"/dashboard/menu/de"}]})),c.a.createElement("div",{className:"col-12 col-md-5"},c.a.createElement(de,{key:Math.random().toString()})),c.a.createElement("div",{className:"col-12"},c.a.createElement(p.d,null,c.a.createElement(p.b,{path:"/dashboard/menu/edit/:id/",component:oe}),c.a.createElement(p.b,{path:"/dashboard/menu/:category/",component:ne}))))}}]),a}(c.a.Component),ue=(a(88),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:"",loggingIn:!1},e.updateData=function(t){e.setState(Object(F.a)({},t.target.id,t.target.value))},e.login=function(){""!==e.state.email&&""!==e.state.password&&A.authenticate(e.state.email,e.state.password).then((function(t){e.props.login(t.user,t.operator_token)})).catch((function(e){window.alert("Invalid Credentials")}))},e}return Object(d.a)(a,[{key:"render",value:function(){return this.props.auth.loggedIn?c.a.createElement(p.a,{to:"/dashboard/menu"}):c.a.createElement("div",{className:"row justify-content-center",id:"login-panel"},c.a.createElement("div",{className:"class-12 class-md-6"},c.a.createElement("div",{className:"wrapper fadeInDown"},c.a.createElement("div",{id:"formContent"},c.a.createElement("div",{className:"fadeIn first"},c.a.createElement("h5",null,"Welcome to the Operator Dashboard!")),c.a.createElement("form",null,c.a.createElement("input",{type:"text",className:"fadeIn second",id:"email",placeholder:"email",value:this.state.email,onChange:this.updateData}),c.a.createElement("input",{type:"password",className:"fadeIn third",id:"password",placeholder:"password",value:this.state.password,onChange:this.updateData}),c.a.createElement("input",{type:"button",className:"fadeIn fourth",value:"Log In",onClick:this.login})),c.a.createElement("div",{id:"formFooter"},c.a.createElement("a",{className:"underlineHover",href:"/"},"Forgot Password?"))))))}}]),a}(c.a.Component)),pe=Object(v.b)((function(e){return{auth:e.authReducer}}),(function(e){return{login:Object(h.b)(w,e)}}))(ue),he=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="order",e.getCompletedOrders=function(t){return e._get("".concat(e.appName,"/").concat(e.view,"/get_completed/?date=").concat(t))},e}return a}(M)),ve=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,orders:[],editId:0,startDate:"",endDate:""},e.orderStatuses=["canceled","pending","paid"],e.componentDidMount=function(){e.getByDateRange()},e.getByDateRange=function(t,a){e.setState({loading:!0}),he.get().then((function(t){e.setState({orders:t,loading:!1})}))},e.searchByOrderDateRange=function(){e.getByDateRange(""!==e.state.startDate?e.state.startDate:void 0,""!==e.state.endDate?e.state.endDate:void 0)},e.updateData=function(t){e.setState(Object(F.a)({},t.target.id,t.target.value))},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return this.state.loading?c.a.createElement("div",null,"Loading..."):this.state.editId>0?c.a.createElement(p.a,{to:"/dashboard/orders/edit/".concat(this.state.editId)}):c.a.createElement("div",{className:"row orders"},c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-md-3"},"Start Date: ",c.a.createElement("input",{type:"date",id:"startDate",value:this.state.startDate,onChange:this.updateData})),c.a.createElement("div",{className:"col-12 col-md-9"},"End Date: ",c.a.createElement("input",{type:"date",id:"endDate",value:this.state.endDate,onChange:this.updateData}),"\xa0\xa0",c.a.createElement("button",{className:"btn btn-success",onClick:this.searchByOrderDateRange},"Search"))),0===this.state.orders.length?c.a.createElement("div",null,"No Orders Found"):c.a.createElement("table",{className:"table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Name"),c.a.createElement("th",null,"Order ID"),c.a.createElement("th",null,"Contact"),c.a.createElement("th",null,"Date"),c.a.createElement("th",null,"Status"))),c.a.createElement("tbody",null,this.state.orders.sort((function(e,t){return e.id>t.id?-11:e.id<t.id?1:0})).map((function(t,a){var n=[];return t.items.forEach((function(e){e.cart_item.quantity,e.cart_item.quantity*e.cart_item.price,-1===n.indexOf(e.cart_item.delivery_date)&&n.push(e.cart_item.delivery_date)})),c.a.createElement("tr",{key:t.id,className:a%2?"":"orders-line-highlight",onClick:function(){return e.setState({editId:t.id})}},c.a.createElement("td",null,t.contact_name),c.a.createElement("td",null,t.public_id),c.a.createElement("td",null,t.email,c.a.createElement("br",null),t.phone_number),c.a.createElement("td",null,W.formatDate(t.created_at)),c.a.createElement("td",{className:"order-status-".concat(t.order_status)},e.orderStatuses[t.order_status]))}))))))}}]),a}(c.a.Component),_e=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="order_item",e.getCompleted=function(t){return e._get("".concat(e.appName,"/").concat(e.view,"/get_completed/?date=").concat(t))},e}return a}(M)),fe=(a(89),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={pullDate:"",orderItems:[],pullType:"route",orders:[]},e.componentDidMount=function(){},e.loadData=function(){"prep"===e.state.pullType?e.loadOrderItems():e.loadOrders()},e.loadOrderItems=function(){_e.getCompleted(e.state.pullDate).then((function(t){0!==t.length?e.setState({orderItems:t},(function(){return window.print()})):window.alert("There are not items for this day")})).catch((function(e){return window.alert("Unable to display")}))},e.loadOrders=function(){he.getCompletedOrders(e.state.pullDate).then((function(t){if(0!==t.length)if("route"===e.state.pullType){var a="Address line 1\tAddress line 2\tCity\tState\tZip\tName\tEmail Address\tPhone Number\tExternal ID\tOrder Count\tDriver\n",n=[];t.forEach((function(t){(n=t.items.filter((function(t){return t.cart_item.delivery_date===e.state.pullDate}))).length>0&&(a+="".concat(t.street_address,"\t").concat(t.unit,"\t").concat(t.city,"\tCA\t").concat(t.zip,"\t").concat(t.contact_name,"\t").concat(t.email,"\t").concat(t.phone_number,"\t").concat(t.public_id,"\t").concat(n.length,"\tLee\n"))}));var r=new Blob([a],{type:"text/plain"}),c=document.createElement("a");c.download="delivery_route_".concat(e.state.pullDate,".tsv"),c.href=window.URL.createObjectURL(r),c.click()}else e.setState({orders:t},(function(){return window.print()}));else window.alert("There are not items for this day")})).catch((function(e){return window.alert(e)}))},e.updateData=function(t){e.setState(Object(F.a)({},t.target.id,t.target.value))},e}return Object(d.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-md-6 export-panel"},c.a.createElement("select",{id:"pullType",className:"control-form",onChange:this.updateData,defaultValue:this.state.pullType},c.a.createElement("option",{value:"prep"},"Prep List"),c.a.createElement("option",{value:"delivery_tags"},"Delivery Tags"),c.a.createElement("option",{value:"route"},"Route CSV")),c.a.createElement("br",null),c.a.createElement("br",null),"Select a date:",c.a.createElement("input",{type:"date",id:"pullDate",className:"form-control",value:this.state.pullDate,onChange:this.updateData}),c.a.createElement("button",{className:"btn btn-success mt-2",onClick:this.loadData},"Print")),this.state.orderItems.length+this.state.orders.length>0&&c.a.createElement("div",{className:"col-12 print-sheet"},"prep"===this.state.pullType?c.a.createElement(ge,{orderItems:this.state.orderItems,date:this.state.pullDate}):c.a.createElement(ye,{orders:this.state.orders,date:this.state.pullDate})))}}]),a}(c.a.Component));function ye(e){return c.a.createElement("div",{className:"delivery_tags_print"},e.orders.map((function(t){var a=t.items.filter((function(t){return t.cart_item.delivery_date===e.date}));return c.a.createElement(r.Fragment,{key:"order_".concat(t.id)},c.a.createElement("div",{className:"quarter-page"},c.a.createElement("span",{className:"contact-info"},t.contact_name),c.a.createElement("span",{className:"street-address"},t.street_address," ",t.unit),c.a.createElement("span",{className:"street-address"},t.city," ",t.zip),c.a.createElement("span",{className:"contact-info"},t.phone_number),c.a.createElement("b",null,"Items:"),c.a.createElement("div",{className:"delivery-tag-items"},a.map((function(e){return c.a.createElement("div",{className:"delivery-tag-item",key:"oi_".concat(e.id)},e.cart_item.quantity.toString()+" "+W.extractCartItemDescription(e.cart_item))}))),t.notes&&c.a.createElement("div",{className:"delivery-instructions"},c.a.createElement("br",null),"_______________________________",c.a.createElement("h4",null,"Delivery Instructions:"),c.a.createElement("div",{className:"delivery_instructions_text"},t.notes))))})))}function ge(e){var t=["No","mild","spicy"],a={},n="",i="",l="",o="",s=0;return e.orderItems.forEach((function(e){i=e.cart_item.menu_item.name,l=e.cart_item.menu_item.proteins.split(":").length>1&&""!==e.cart_item.protein?e.cart_item.protein:"",o=e.cart_item.menu_item.spicy?t[e.cart_item.spicy]:"",(n="".concat(i,":").concat(l,":").concat(o))in a||(a[n]={count:0,dish:i,protein:l,spicy_text:o}),a[n].count+=e.cart_item.quantity,s+=e.cart_item.quantity})),c.a.createElement(r.Fragment,null,c.a.createElement("span",{className:"print-sheet-header"},e.date," \xa0\xa0:\xa0\xa0",s," items"),c.a.createElement("table",{className:"prep-sheet"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("td",null,"#"),c.a.createElement("td",null,"Dish"),c.a.createElement("td",null,"Protein"),c.a.createElement("td",null,"Spicy"),c.a.createElement("td",null,"L"),c.a.createElement("td",null,"P"))),c.a.createElement("tbody",null,Object.keys(a).sort().map((function(e,t){return c.a.createElement("tr",{className:"".concat(t%2?"":"print-row-dark"),key:e},c.a.createElement("td",null,a[e].count),c.a.createElement("td",null,a[e].dish),c.a.createElement("td",null,a[e].protein),c.a.createElement("td",null,a[e].spicy_text),c.a.createElement("td",null),c.a.createElement("td",null))})))))}var be=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",m=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"",h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:[],v=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"",_=arguments.length>12&&void 0!==arguments[12]?arguments[12]:"",f=arguments.length>13&&void 0!==arguments[13]?arguments[13]:"",y=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0;return Object(s.a)(this,a),(e=t.call(this)).order_status=void 0,e.square_payment=void 0,e.contact_name=void 0,e.phone_number=void 0,e.email=void 0,e.unit=void 0,e.street_address=void 0,e.city=void 0,e.zip=void 0,e.notes=void 0,e.items=void 0,e.uuid=void 0,e.public_id=void 0,e.nonce=void 0,e.tip=void 0,e.id=n,e.order_status=r,e.contact_name=c,e.phone_number=i,e.email=l,e.unit=o,e.street_address=d,e.city=m,e.zip=u,e.notes=p,e.items=h,e.uuid=v,e.public_id=_,e.nonce=f,e.tip=y,e}return a}(y),Ee=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this)).order_status=void 0,n.contact_name=void 0,n.phone_number=void 0,n.email=void 0,n.unit=void 0,n.street_address=void 0,n.city=void 0,n.zip=void 0,n.cart_items=void 0,n.notes=void 0,n.nonce=void 0,n.tip=void 0,n.coupon=void 0,n.order_status=e.order_status,n.contact_name=e.contact_name,n.phone_number=e.phone_number,n.email=e.email,n.unit=e.unit,n.street_address=e.street_address,n.city=e.city,n.zip=e.zip,n.notes=e.notes,n.nonce=e.nonce,n.tip=e.tip,n}return a}(y),we=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).sendWeeklyEmails=function(){return e._get("dashboard/send_weekly_email/")},e.sendSupportEmail=function(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c={to:t,subject:a,body:n};return null!==r&&(c.order_id=r.id),e._post("dashboard/send_support_email/",c)},e.sendMassMail=function(t,a){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e._post("dashboard/send_mass_mail/",{body:t,options:a,send_email:n})},e}return a}(M)),Ne=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).submit=function(){n.setState({submitting:!0}),we.sendSupportEmail(n.props.order.email,n.state.subject,n.state.body,n.state.include_order?n.props.order:null).then((function(){window.alert("Email Sent"),n.setState({subject:"",body:"",include_order:!0})})).catch((function(e){return window.alert("unable to send email")})).then((function(){return n.setState({submitting:!1})}))},n.toggleIncludeOrder=function(){console.log(n.state.include_order),n.setState({include_order:!n.state.include_order})},n.updateData=function(e){n.setState(Object(F.a)({},e.target.id,e.target.value))},n.state={subject:"Order ".concat(e.order.public_id),body:"",include_order:!0,submitting:!1},n}return Object(d.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"row order_email"},c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement("label",null,"subject:"),c.a.createElement("input",{className:"form-control order_email__subject",id:"subject",value:this.state.subject,onChange:this.updateData,disabled:this.state.submitting})),c.a.createElement("div",{className:"col-12 mt-3"},c.a.createElement("label",null,"Message"),c.a.createElement("textarea",{className:"form-control order_email__body",id:"body",value:this.state.body,onChange:this.updateData,disabled:this.state.submitting,rows:8})),c.a.createElement("div",{className:"col-12 mt-3"},"Include Order: \xa0\xa0",c.a.createElement("input",{className:"order_email__include_order",type:"checkbox",id:"include_order",checked:this.state.include_order,onChange:this.toggleIncludeOrder,disabled:this.state.submitting})),c.a.createElement("div",{className:"col-12 mt-3"},c.a.createElement("button",{className:"btn btn-success order_email__submit",disabled:""===this.state.subject||""===this.state.body||this.state.submitting,onClick:this.submit},"Send Email")))}}]),a}(c.a.Component),Oe=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,order:new be,updating:!1,updatesPending:!1,returnToOrders:!1},e.componentDidMount=function(){var t=e.props.match.params;he.get(t.id).then((function(t){return e.setState({order:t,loading:!1})})).catch((function(e){return window.alert(e)}))},e.saveUpdates=function(){e.setState({updating:!0}),he.update(e.state.order.id,new Ee(e.state.order)).then((function(t){return e.setState({order:t,updating:!1,updatesPending:!1,returnToOrders:!0})})).catch((function(e){return window.alert(e)}))},e.updateData=function(t){var a=e.state.order;a[t.target.id]=t.target.value,e.setState({order:a,updatesPending:!0})},e}return Object(d.a)(a,[{key:"render",value:function(){if(this.state.loading)return c.a.createElement("div",null,"Loading...");if(this.state.returnToOrders)return c.a.createElement(p.a,{to:"/dashboard/orders"});var e=W.sortOrderItemsByDate(this.state.order.items);return c.a.createElement("div",{className:"row edit_order"},c.a.createElement("div",{className:"col-12"},c.a.createElement(T.b,{to:"/dashboard/orders"},"<<< Return to Orders"),c.a.createElement("br",null),c.a.createElement("br",null)),c.a.createElement("div",{className:"col-12"},c.a.createElement("h5",null,"Order ID: ",this.state.order.public_id),c.a.createElement("select",{id:"order_status",defaultValue:this.state.order.order_status,className:"order_status order_status--".concat(this.state.order.order_status),onChange:this.updateData,disabled:this.state.updating},c.a.createElement("option",{value:"0"},"Canceled"),c.a.createElement("option",{value:"1"},"Pending"),c.a.createElement("option",{value:"2"},"Paid"))),c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement("div",{className:"form-group mt-2"},c.a.createElement("label",{htmlFor:"contact_name"},"contact name"),c.a.createElement("input",{id:"contact_name",type:"text",className:"form-control",disabled:this.state.updating,value:this.state.order.contact_name,onChange:this.updateData})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"phone_number"},"phone number"),c.a.createElement("input",{id:"phone_number",type:"text",className:"form-control",disabled:this.state.updating,value:this.state.order.phone_number,onChange:this.updateData})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"city"},"city"),c.a.createElement("input",{id:"city",type:"text",className:"form-control",disabled:this.state.updating,value:this.state.order.city,onChange:this.updateData})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"zip"},"zip"),c.a.createElement("input",{id:"zip",type:"text",className:"form-control",disabled:this.state.updating,value:this.state.order.zip,onChange:this.updateData}))),c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"email"},"email"),c.a.createElement("input",{id:"email",type:"email",className:"form-control",disabled:this.state.updating,value:this.state.order.email,onChange:this.updateData})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"street_address"},"Street Address"),c.a.createElement("input",{id:"street_address",type:"text",className:"form-control",disabled:this.state.updating,value:this.state.order.street_address,onChange:this.updateData})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"unit"},"unit"),c.a.createElement("input",{id:"unit",type:"text",className:"form-control",disabled:this.state.updating,value:this.state.order.unit,onChange:this.updateData})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"notes"},"delivery notes"),c.a.createElement("textarea",{id:"notes",className:"form-control",disabled:this.state.updating,value:this.state.order.notes,onChange:this.updateData}))),c.a.createElement("div",{className:"col-2"},c.a.createElement("pre",null,c.a.createElement("code",{className:"prettyprint"},JSON.stringify(this.state.order.square_payment,null,4)))),c.a.createElement("div",{className:"col-12"},c.a.createElement("button",{className:"btn btn-success",onClick:this.saveUpdates,disabled:!this.state.updatesPending||this.state.updating},"Save Updates")),c.a.createElement("div",{className:"col-12 edit_order_deliveries"},c.a.createElement("hr",null),c.a.createElement("h5",null,"Deliveries:"),Object.keys(e).sort().map((function(t){return c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-12"},c.a.createElement("b",null,W.formatDate(t)),e[t].map((function(e){return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},"\xa0\xa0\xa0",e.cart_item.quantity,"\xa0",W.extractCartItemDescription(e.cart_item)))}))))}))),c.a.createElement("div",{className:"col-12"},c.a.createElement("hr",null),c.a.createElement("h5",null,"Email Customer:"),c.a.createElement(Ne,{order:this.state.order})))}}]),a}(c.a.Component),De=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,c,i,l,o,d,m,u){var p;Object(s.a)(this,a),(p=t.call(this)).code=void 0,p.mode=void 0,p.calculation_type=void 0,p.expire=void 0,p.start_value=void 0,p.current_value=void 0,p.remaining_uses=void 0,p.email=void 0,p.active=void 0;var h=new Date;return h.setDate(h.getDate()+60),p.id=e||-1,p.code=n||"",p.active=!1!==r,p.mode=c||0,p.calculation_type=i||0,p.expire=l||Object(P.a)(h,"yyyy-mm-dd"),p.start_value=o||0,p.current_value=d||0,p.remaining_uses=m||0,p.email=u||"",p}return a}(y),je=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="coupon",e}return a}(M)),ke=(a(43),function(e){var t=Object(r.useState)(e.coupon),a=Object(te.a)(t,2),n=a[0],i=a[1],l=Object(r.useState)(!1),o=Object(te.a)(l,2),s=o[0],d=o[1];return c.a.createElement("tr",{className:"coupon ".concat(e.coupon.active?"":"coupon--inactive")},c.a.createElement("td",null,n.active&&c.a.createElement("button",{className:"btn btn-outline-danger coupon__deactivate",disabled:s,onClick:function(){window.confirm("Are you sure you want to deactivate:\n".concat(n.code,"\n\nCoupons cannot be reactivated!"))&&(d(!0),n.active=!1,je.update(n.id,n).then((function(t){i(t),e.couponUpdated(t)})).catch((function(e){return console.log(e)})))}},"X")),c.a.createElement("td",{className:"coupon__code"},n.code),c.a.createElement("td",{className:"coupon__mode"},["standard","one off"][n.mode]),c.a.createElement("td",{className:"coupon__mode"},["percentage","fixed"][n.calculation_type]),c.a.createElement("td",{className:"coupon__uses"},n.remaining_uses),c.a.createElement("td",{className:"coupon__start_value"},0===e.coupon.calculation_type?"".concat(100*n.start_value,"%"):"$".concat(n.start_value.toFixed(2))),c.a.createElement("td",{className:"coupon__end_value"},0===n.calculation_type?"":"$".concat(n.current_value.toFixed(2))),c.a.createElement("td",{className:"coupon__expire"},W.formatDate(n.expire)),c.a.createElement("td",{className:"coupon__email"},n.email))}),Se=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,coupons:[],addingCoupon:!1},e.componentDidMount=function(){je.get().then((function(t){return e.setState({coupons:t,loading:!1})})).catch((function(e){return console.log(e)}))},e.couponUpdated=function(t){e.setState({coupons:e.state.coupons.map((function(e){return e.id===t.id?t:e}))})},e.addCoupon=function(){e.setState({addingCoupon:!0}),je.add(new De).then((function(t){e.props.history.push({pathname:"/dashboard/coupon/edit/".concat(t.id)})})).catch((function(e){return window.alert("Unable to create coupon")}))},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;if(this.state.loading)return c.a.createElement(le,null);var t=this.state.coupons.sort((function(e,t){return e.active<t.active?1:e.active>t.active?-1:0}));return c.a.createElement("div",{className:"row coupons"},c.a.createElement("div",{className:"col-12 mb-2"},c.a.createElement("div",{className:"add_coupon",onClick:function(){return e.props.history.push({pathname:"/dashboard/coupon/add"})}},this.state.addingCoupon?"Creating coupon...":"+ Add Coupon")),c.a.createElement("div",{className:"col-12"},c.a.createElement("table",{className:"table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null),c.a.createElement("th",null,"code"),c.a.createElement("th",null,"mode"),c.a.createElement("th",null,"calculation"),c.a.createElement("th",null,"uses"),c.a.createElement("th",null,"start value"),c.a.createElement("th",null,"current value"),c.a.createElement("th",null,"expire"),c.a.createElement("th",null,"email"))),c.a.createElement("tbody",null,t.map((function(t){return c.a.createElement(ke,{coupon:t,key:"c_".concat(t.id),couponUpdated:e.couponUpdated})}))))))}}]),a}(c.a.Component),Ie=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loaded:!1,deliveryDay:new B,startDate:"",endDate:"",duplicating:!1},e.componentDidMount=function(){var t=e.props.match.params;R.get(t.id).then((function(t){e.setState({deliveryDay:t,loaded:!0})}))},e.datesAreValid=function(){return""!==e.state.startDate&&""!==e.state.endDate&&e.state.endDate>e.state.startDate},e.duplicate=function(){window.confirm("Are you sure you want duplicate: ".concat(e.state.startDate," to ").concat(e.state.endDate))&&R.duplicateDeliveryDay(e.state.deliveryDay,e.state.startDate,e.state.endDate).then((function(t){e.props.history.push({pathname:"/dashboard/delivery/edit/".concat(t.id)})})).catch((function(e){return window.alert("Unable to duplicate")}))},e.updateData=function(t){e.setState(Object(F.a)({},t.target.id,t.target.value))},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return this.state.loaded?c.a.createElement("div",{className:"row delivery_duplicate"},c.a.createElement("div",{className:"col-12 delivery_duplicate__dates"},W.formatDate(this.state.deliveryDay.date)," - ",W.formatDate(this.state.deliveryDay.end_date),c.a.createElement("hr",null)),c.a.createElement("div",{className:"col-12"},"Duplicate to:"),c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-md-2 delivery_duplicate__date"},c.a.createElement("small",null,"start date"),c.a.createElement("br",null),c.a.createElement("input",{type:"date",id:"startDate",value:this.state.startDate,disabled:this.state.duplicating,onChange:this.updateData})),c.a.createElement("div",{className:"col-12 col-md-2 delivery_duplicate__date"},c.a.createElement("small",null,"end date"),c.a.createElement("br",null),c.a.createElement("input",{type:"date",id:"endDate",value:this.state.endDate,disabled:this.state.duplicating,onChange:this.updateData})))),c.a.createElement("div",{className:"col-12 mt-3"},c.a.createElement("button",{className:"btn btn-success duplicate_btn",disabled:!this.datesAreValid(),onClick:this.duplicate},"Duplicate"),c.a.createElement("button",{className:"btn btn-default ml-3",onClick:function(){return e.props.history.push({pathname:"/dashboard/deliveries"})}},"Cancel")),c.a.createElement("div",{className:"col-12 delivery_duplicate_items"},c.a.createElement("hr",null),c.a.createElement("div",{className:"row"},this.state.deliveryDay.day_items.map((function(e){return c.a.createElement("div",{className:"col-12 col-md-3 delivery_duplicate_items__item",key:"di_".concat(e.id)},e.menu_item.name,c.a.createElement("img",{src:e.menu_item.image,alt:e.menu_item.name}))}))))):c.a.createElement(le,null)}}]),a}(c.a.Component),Ce=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={saving:!1,coupon:new De},e.cancel=function(){window.confirm("Are you sure you want to cancel?")&&e.props.history.push("/dashboard/coupons")},e.save=function(){e.setState({saving:!0});var t=e.state.coupon;0===t.calculation_type&&t.start_value>1&&(t.start_value=.01*t.start_value),je.add(e.state.coupon).then((function(){})).catch((function(e){return alert("unable to add coupon")})).finally((function(){return e.setState({saving:!1})}))},e.updateData=function(t){var a=e.state.coupon;a[t.target.id]=t.target.value,e.setState({coupon:a})},e}return Object(d.a)(a,[{key:"render",value:function(){return this.state.saving?c.a.createElement(le,null):c.a.createElement("div",{className:"row justify-content-center edit_coupon"},c.a.createElement("div",{className:"col-12 col-md-4"},c.a.createElement("h3",null,"Add Coupon"),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-6 mt-3"},"Mode:",c.a.createElement("select",{id:"mode",className:"form-control edit_coupon__mode",value:this.state.coupon.mode,onChange:this.updateData},c.a.createElement("option",{value:0},"standard"),c.a.createElement("option",{value:1},"one off"))),c.a.createElement("div",{className:"col-12 col-6 mt-3"},"Calculation:",c.a.createElement("select",{id:"calculation_type",className:"form-control edit_coupon__calculation_type",value:this.state.coupon.calculation_type,onChange:this.updateData},c.a.createElement("option",{value:0},"percentage"),c.a.createElement("option",{value:1},"fixed value"))),c.a.createElement("div",{className:"col-12 col-6 mt-3 edit_coupon__start_value"},"value:",c.a.createElement("input",{id:"start_value",value:this.state.coupon.start_value||"",onChange:this.updateData,className:"form-control"})),c.a.createElement("div",{className:"col-12 col-6 mt-3 edit_coupon__email"},"uses:",c.a.createElement("input",{id:"remaining_uses",type:"number",value:this.state.coupon.remaining_uses,onChange:this.updateData,className:"form-control"})),c.a.createElement("div",{className:"col-12 col-6 mt-3 edit_coupon__email"},"expire:",c.a.createElement("input",{id:"expire",value:this.state.coupon.expire,onChange:this.updateData,type:"date",className:"form-control"})),c.a.createElement("div",{className:"col-12 col-6 mt-3 edit_coupon__email"},"email:",c.a.createElement("input",{id:"email",value:this.state.coupon.email,onChange:this.updateData,className:"form-control"})),c.a.createElement("div",{className:"col-12 mt-3"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("button",{className:"btn btn-success mr-3",onClick:this.save},"save"),c.a.createElement("button",{className:"btn btn-outline-default edit_coupon__cancel",onClick:this.cancel},"cancel"))))),this.state.saving&&c.a.createElement(le,null))}}]),a}(c.a.Component),xe=(a(44),function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={runningRemoteFunction:!1},e.doFunction=function(t){window.confirm("Are you sure you want to send mails?")&&(e.setState({runningRemoteFunction:!0}),we.sendWeeklyEmails().then((function(t){window.alert("".concat(t.send_count," emails were sent")),e.setState({runningRemoteFunction:!1})})))},e}return Object(d.a)(a,[{key:"render",value:function(){return this.state.runningRemoteFunction?c.a.createElement("div",null,"One Moment..."):c.a.createElement("div",{className:"row mail-utilities"},c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement("h3",null,"Mass Mailings"),c.a.createElement("hr",null)),c.a.createElement("div",{className:"col-3"},c.a.createElement("button",{id:"weekly_menu",className:"btn btn-success",onClick:this.doFunction},"Weekly Menu")))))}}]),a}(c.a.Component)),Me=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="mailing_list",e}return a}(M)),Ae=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){Me.get().then((function(e){return n.setState({mailingList:e,loaded:!0})}))},n.state={mailingList:[],loaded:!1},n}return Object(d.a)(a,[{key:"render",value:function(){return this.state.loaded?c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},this.state.mailingList.map((function(e){return c.a.createElement("h3",null,e.email)})))):c.a.createElement("div",null,"Loading...")}}]),a}(c.a.Component),Te=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="mail_template",e.get_template_by_slug=function(t){return e._get("".concat(e.appName,"/").concat(e.view,"/get_template_by_slug/?slug=").concat(t))},e}return a}(M)),Ue=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e,n,r){var c;return Object(s.a)(this,a),(c=t.call(this)).slug=void 0,c.text=void 0,c.options=void 0,c.slug=e||"",c.text=n||"",c.options=r||{},c}return a}(y),Le=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).saveUpdates=function(){n.setState({updating:!0});var e=n.state.template;e.text=n.state.text,e.id<0?(e.slug=n.props.templateSlug,e.options="",Te.add(e).then((function(){return n.setState({originalText:n.state.text})})).catch((function(e){return window.alert("unable to save")})).then((function(){return n.setState({updating:!1})}))):Te.update(e.id,e).then((function(){return n.setState({originalText:n.state.text})})).catch((function(e){return window.alert("unable to update")})).then((function(){return n.setState({updating:!1})}))},n.state={loading:!0,updating:!1,template:new Ue,text:"",originalText:""},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;Te.get_template_by_slug(this.props.templateSlug).then((function(t){e.setState({text:t.text,originalText:t.text,template:t,loading:!1})})).catch((function(){})).then((function(){return e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this;return this.state.loading?c.a.createElement(le,null):c.a.createElement("div",{className:"row mail_template"},c.a.createElement("div",{className:"col-12"},c.a.createElement("hr",null)),c.a.createElement("div",{className:"col-12"},this.props.templateSlug.replace(/-/g," ")),c.a.createElement("div",{className:"col-12 "},c.a.createElement("textarea",{className:"mail_template__body",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})},disabled:this.state.updating}),"(",this.state.text.length," characters)"),c.a.createElement("div",{className:"col-12"},c.a.createElement("button",{className:"btn btn-".concat(this.state.updating||this.state.text===this.state.originalText?"default":"success"),onClick:function(){return e.saveUpdates()},disabled:this.state.updating||this.state.text===this.state.originalText},"Update")))}}]),a}(c.a.Component),Fe=function(){return c.a.createElement("div",{className:"row mail_template"},c.a.createElement("div",{className:"col-12 col-md-4"},["upcoming-delivery","upcoming-delivery-day","newsletter"].map((function(e){return c.a.createElement(Le,{templateSlug:e,key:e})}))))},Pe=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="delivery_window",e.listWithCounts=function(t){return e._get("".concat(e.appName,"/").concat(e.view,"/list_with_counts/?target_date=").concat(W.dateToShortISO(t)))},e.retrieveOrders=function(t,a){return e._get("".concat(e.appName,"/").concat(e.view,"/").concat(t,"/retrieve_orders/?target_date=").concat(W.dateToShortISO(a)))},e}return a}(M)),Re=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,c,i,l,o){var d;return Object(s.a)(this,a),(d=t.call(this)).name=void 0,d.active=void 0,d.start_time=void 0,d.end_time=void 0,d.day=void 0,d.one_off_date=void 0,d.name=n||"delivery_window",d.start_time=r||"11:00:00",d.end_time=c||"13:00:00",d.day=i||0,d.id=e||-1,d.active=l||!0,d.one_off_date=o||"",d}return a}(y),Be=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={who:"all_customers",deliveryDays:[],deliveryWindows:[],message:"",deliveryWindowId:0,deliveryDate:"",deliveryDay:new B,includeSamples:!1},e.componentDidMount=function(){Promise.all([R.get(),Pe.get()]).then((function(t){var a="all_customers",n="",r=t[1],c=r.length>0?r[0]:new Re,i=t[0].length>0?t[0][0]:new B,l=e.props.match.params,o="option"in l?l.option:"";if("mail_type"in l)switch(l.mail_type){case"upcoming_delivery":a="upcoming_delivery",n=o}e.setState({who:a,deliveryDate:n,deliveryDays:t[0],deliveryDay:i,deliveryWindows:r,deliveryWindowId:c.id})}))},e.goodToSend=function(){var t=e.state.who;return""!==e.state.message&&("all_customers"==t||"delivery_window"==t||"upcoming_delivery_days"==t||"upcoming_delivery"==t&&""!==e.state.deliveryDate)},e.sendMail=function(){var t="Send to all customers",a={};switch(e.state.includeSamples&&(a.include_menu_sample=!0),e.state.who){case"delivery_window":t="Send to customers in the selected delivery window.",a.delivery_window=e.state.deliveryWindowId;break;case"upcoming_delivery":t="Send to customers receiving a delivery on: ".concat(e.state.deliveryDate),a.delivery_date=e.state.deliveryDate;break;case"upcoming_delivery_days":t="Send to customers in the delivery days ".concat(e.state.deliveryDay.date," to ").concat(e.state.deliveryDay.end_date);break;default:a.all_customers=!0}window.confirm("You about to initiate the following: \n\n".concat(t,"\n\nContinue?"))&&we.sendMassMail(e.state.message,a).then((function(n){0!==n.count?window.confirm("".concat(t,"\n\nwill produce approx. ").concat(n.count," emails.\n\nSend?"))&&we.sendMassMail(e.state.message,a,!0).then((function(e){return window.alert("".concat(e.count," emails were sent"))})):window.alert("".concat(t," did not produce any emails."))}))},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"row mass_mailer justify-content-center"},c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement("div",{className:"col-12"},c.a.createElement("label",null,"message:"),c.a.createElement("textarea",{className:"mass_mailer__message form-control",value:this.state.message,onChange:function(t){return e.setState({message:t.target.value})}}),"(",this.state.message.length," characters)"),c.a.createElement("div",{className:"col-12 mt-3 mass_mailer_send_to"},"send to:",c.a.createElement("br",null),c.a.createElement("div",{className:"mass_mailer_send_to__option"},c.a.createElement("input",{type:"radio",name:"to",id:"all_customers",checked:"all_customers"===this.state.who,onChange:function(){return e.setState({who:"all_customers"})}})," all customers",c.a.createElement("br",null),c.a.createElement("span",null,"anyone who has completed an order")),c.a.createElement("div",{className:"mass_mailer_send_to__option"},c.a.createElement("input",{type:"radio",name:"to",id:"delivery_window",disabled:0===this.state.deliveryWindows.length,checked:"delivery_window"===this.state.who,onChange:function(){return e.setState({who:"delivery_window"})}})," delivery window",c.a.createElement("br",null),c.a.createElement("span",null,"customers in the window selected below")),c.a.createElement("div",{className:"mass_mailer_send_to__option"},c.a.createElement("input",{type:"radio",name:"to",id:"upcoming_delivery",checked:"upcoming_delivery"===this.state.who,onChange:function(){return e.setState({who:"upcoming_delivery"})}})," upcoming delivery",c.a.createElement("br",null),c.a.createElement("span",null,"customers receiving a delivery on the date selected below")),c.a.createElement("div",{className:"mass_mailer_send_to__option"},c.a.createElement("input",{type:"radio",name:"to",id:"upcoming_delivery_days",disabled:0===this.state.deliveryDays.length,checked:"upcoming_delivery_days"===this.state.who,onChange:function(){return e.setState({who:"upcoming_delivery_days"})}})," upcoming delivery days",c.a.createElement("br",null),c.a.createElement("span",null,"customers receiving an order during the deliver days selected below"))),c.a.createElement("div",{className:"col-12 mt-3 mass_mailer__options"},"upcoming_delivery"===this.state.who&&c.a.createElement(r.Fragment,null,"select a delivery day:",c.a.createElement("input",{type:"date",value:this.state.deliveryDate,onChange:function(t){return e.setState({deliveryDate:t.target.value})},className:"form-control options__upcoming_delivery"})),"upcoming_delivery_days"===this.state.who&&c.a.createElement(r.Fragment,null,"select delivery days:",c.a.createElement("select",{className:"form-control options__upcoming_delivery_days"},this.state.deliveryDays.map((function(e){return c.a.createElement("option",{key:"dd_".concat(e.id)},"".concat(e.date," to ").concat(e.end_date))})))),"delivery_window"===this.state.who&&c.a.createElement(r.Fragment,null,"select delivery window:",c.a.createElement("select",{className:"form-control options__delivery_windows",onChange:function(t){return e.setState({deliveryWindowId:parseInt(t.target.value)})}},this.state.deliveryWindows.map((function(e){return c.a.createElement("option",{key:"wi_".concat(e.id),value:e.id},e.name)}))))),c.a.createElement("div",{className:"col-12 mt-3 mass_mailer__includes"},"upcoming_delivery_days"!==this.state.who&&c.a.createElement(r.Fragment,null,c.a.createElement("input",{type:"checkbox",className:"includes__include_samples",checked:this.state.includeSamples,onChange:function(t){return e.setState({includeSamples:!e.state.includeSamples})}})," \xa0\xa0Include Upcoming Menu Samples")),c.a.createElement("div",{className:"col-12 mt-3 mass_mailer__buttons text-center"},c.a.createElement("button",{className:"btn btn-success buttons__send",disabled:!this.goodToSend(),onClick:this.sendMail},"Send Mass Mail"))))}}]),a}(c.a.Component),Ve=function(){return c.a.createElement("div",{className:"row mail"},c.a.createElement("div",{className:"col-12"},c.a.createElement(se,{navItems:[{title:"Utilities",link:"/dashboard/mail/utility"},{title:"Templates",link:"/dashboard/mail/template"},{title:"Mailing List",link:"/dashboard/mail/list"},{title:"Mass Mailer",link:"/dashboard/mail/mass_mailer"}]})),c.a.createElement("div",{className:"col-12"},c.a.createElement(p.d,null,c.a.createElement(p.b,{path:"/dashboard/mail/list/",component:Ae}),c.a.createElement(p.b,{path:"/dashboard/mail/template",component:Fe}),c.a.createElement(p.b,{path:"/dashboard/mail/mass_mailer/:mail_type/:option",component:Be}),c.a.createElement(p.b,{path:"/dashboard/mail/mass_mailer",component:Be}),c.a.createElement(p.b,{path:"/dashboard/mail/",component:xe}))))},We=new(function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).appName="dashboard",e.view="newsletter",e.release=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e._get("".concat(e.appName,"/").concat(e.view,"/").concat(t,"/release/?send_email=").concat(a))},e.sendEmailSample=function(t,a,n){return e._get("".concat(e.appName,"/").concat(e.view,"/").concat(t,"/send_email_sample/?email=").concat(a))},e}return a}(M)),ze=(a(45),function(e){var t=Object(p.g)();return c.a.createElement("tr",{className:"newsletters_newsletter"},c.a.createElement("td",null,e.newsletter.title),c.a.createElement("td",null,null!==e.newsletter.release_date&&void 0!==e.newsletter.release_date?W.formatDate(e.newsletter.release_date):c.a.createElement("span",null,"click 'Edit' to release")),c.a.createElement("td",null,c.a.createElement("button",{className:"btn btn-success",onClick:function(){return t.push({pathname:"/dashboard/newsletter/edit/".concat(e.newsletter.id)})}},"Edit")))}),qe=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,c){var i;return Object(s.a)(this,a),(i=t.call(this)).title=void 0,i.content=void 0,i.release_date=void 0,i.id=e||-1,i.title=n||"",i.content=r||"",i.release_date=c||null,i}return a}(y),Je=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={title:"",creating:!1},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"row newsletter_add"},c.a.createElement("div",{className:"col-12"},c.a.createElement("input",{placeholder:"new newsletter title",value:this.state.title,onChange:function(t){return e.setState({title:t.target.value})}}),c.a.createElement("button",{className:"btn btn-success",disabled:""===this.state.title||this.state.creating,onClick:function(){e.setState({creating:!0}),We.add(new qe(-1,e.state.title,"")).then((function(t){return e.props.history.push({pathname:"/dashboard/newsletter/edit/".concat(t.id)})})).catch((function(e){console.log(e),window.alert("unable to create newsletter")}))}},"Create Newsletter")))}}]),a}(c.a.Component),Ge=Object(p.i)(Je),Ke=function(){var e=Object(r.useState)([]),t=Object(te.a)(e,2),a=t[0],n=t[1],i=Object(r.useState)(!0),l=Object(te.a)(i,2),o=l[0],s=l[1];return Object(r.useEffect)((function(){We.get().then((function(e){n(e),s(!1)})).catch((function(e){return window.alert("unable to load newsletters")}))}),[]),o?c.a.createElement(le,null):c.a.createElement("div",{className:"row newsletters"},c.a.createElement("div",{className:"col-12"},c.a.createElement(Ge,null)),c.a.createElement("div",{className:"col-12"},c.a.createElement("table",{className:"table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"title"),c.a.createElement("th",null,"release"),c.a.createElement("th",null))),c.a.createElement("tbody",null,a.map((function(e){return c.a.createElement(ze,{newsletter:e,key:"nl_".concat(e.id)})}))))))},Ye=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).release=function(){We.release(n.state.newsletter.id).then((function(e){0!==e.count?window.confirm("You are about to send ".concat(e.count," emails.\n\nContinue?"))&&We.release(n.state.newsletter.id,!0).then((function(e){window.alert("".concat(e.count," emails sent"));var t=n.state.newsletter;t.release_date="a",n.setState({newsletter:t})})).catch((function(e){return window.alert("unable to release newsletter")})):window.alert("no emails found")})).catch((function(e){return window.alert("unable to release newsletter")}))},n.saveNewsletter=function(){n.setState({saving:!0});var e=n.state.newsletter;e.title=n.state.title,e.content=n.state.content,We.update(e.id,e).then((function(e){n.setState({newsletter:e,title:e.title,content:e.content,saving:!1})})).catch((function(e){return window.alert("unable to update newsletter")}))},n.sendTestEmail=function(){""!==n.state.email?(n.setState({sendingEmail:!0}),We.sendEmailSample(n.state.newsletter.id,n.state.email).then((function(e){return window.alert("sample mail sent")})).catch((function(e){return window.alert("unable to send sample")})).finally((function(){return n.setState({sendingEmail:!1})}))):window.alert("Enter an email address")},n.state={loading:!0,saving:!1,title:"",content:"",newsletter:new qe,email:"",sendingEmail:!1},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;We.get(t.id).then((function(t){return e.setState({newsletter:t,title:t.title,content:t.content,loading:!1})})).catch((function(e){return window.alert("unable to load newsletter")}))}},{key:"render",value:function(){var e=this;if(this.state.loading)return c.a.createElement(le,null);var t=this.state.title===this.state.newsletter.title&&this.state.content===this.state.newsletter.content||this.state.saving;return c.a.createElement("div",{className:"row newsletter_edit"},c.a.createElement("div",{className:"col-12 newsletter_edit__title"},"title: ",c.a.createElement("br",null),c.a.createElement("input",{value:this.state.title,onChange:function(t){return e.setState({title:t.target.value})},className:"form-control newsletter_edit__title_input",disabled:this.state.saving})),c.a.createElement("div",{className:"col-12 newsletter_edit__content"},"content:",c.a.createElement("textarea",{className:"form-control newsletter_edit__content_input",value:this.state.content,rows:10,onChange:function(t){return e.setState({content:t.target.value})},disabled:this.state.saving}),"(",this.state.content.length," characters)"),c.a.createElement("div",{className:"col-12 newsletter_edit_controls mt-3"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-md-6"},c.a.createElement("button",{className:"btn btn-success newsletter_edit_controls__save_btn",disabled:t,onClick:this.saveNewsletter},"save"),null===this.state.newsletter.release_date&&c.a.createElement("button",{className:"btn btn-outline-warning newsletter_edit_controls__release_btn ml-3",disabled:!t,onClick:this.release},"release")),c.a.createElement("div",{className:"col-12 col-md-6"},-1===this.state.content.indexOf("newsletter__email_title")&&c.a.createElement("div",{className:"newsletter_edit__error"},"Missing 'newsletter__email_title' class"),-1===this.state.content.indexOf("newsletter__email_content")&&c.a.createElement("div",{className:"newsletter_edit__error"},"Missing 'newsletter__email_content' class")),c.a.createElement("div",{className:"col-12"},c.a.createElement("button",{className:"btn btn-outline-success newsletter_edit_controls__email_btn",disabled:!t||this.state.sendingEmail,onClick:this.sendTestEmail},"Send Email Test"),c.a.createElement("input",{className:"form-control mt-3 newsletter_edit_controls__email_input",placeholder:"enter email address",type:"email",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})},disabled:!t||this.state.sendingEmail})))))}}]),a}(c.a.Component),He=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"row home"},c.a.createElement(se,{navItems:[{title:"Browser",link:"/dashboard/browser"}]}))}}]),a}(c.a.Component),Xe=["January","February","March","April","May","June","July","August","September","October","November","December"],$e=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ze=(a(23),function(e){var t=Object(r.useState)(void 0),a=Object(te.a)(t,2),n=a[0],i=a[1],l=Object(p.g)();return Object(r.useEffect)((function(){Pe.listWithCounts(e.date).then((function(e){i(e)})).catch((function(t){return window.alert("unable to load date: ".concat(e.date.toISOString().slice(0,10)))}))}),[]),c.a.createElement("div",{className:"row browser_day nopadding",onClick:function(){return l.push({pathname:"/dashboard/browser/day/".concat(W.dateToShortISO(e.date))})}},c.a.createElement("div",{className:"col-12 nopadding"},c.a.createElement("div",{className:"browser_day__date ".concat(W.dateToShortISO(e.date)==W.dateToShortISO(new Date)?"browser_day__date--today":"")},e.date.getDate()),c.a.createElement("div",{className:"browser_day__windows"},void 0===n?c.a.createElement("div",null):n.map((function(e){return c.a.createElement("div",{className:"browser_day__window",key:"dto_".concat(e.window.id)},c.a.createElement("div",{className:"d-none d-md-block"},e.window.name),c.a.createElement("div",{className:""},"".concat(e.order_count,"  ").concat(e.dish_count)),c.a.createElement("hr",null))})))))}),Qe=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={month:0,year:0,viewDay:0},e.changeMonth=function(t){var a=e.state.month,n=e.state.year;(a+=t)>11?(a=0,n++):a<0&&(a=11,n--),e.props.history.push({pathname:"/dashboard/browser/".concat(a,"/").concat(n)}),e.setState({month:a,year:n})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=(new Date).getMonth(),t=(new Date).getFullYear(),a=this.props.match.params;"month"in a||"year"in a?("month"in a&&(e=parseInt(a.month)),"year"in a&&(t=parseInt(a.year))):this.props.history.push({pathname:"/dashboard/browser/".concat(e,"/").concat(t)}),this.setState({month:e,year:t})}},{key:"render",value:function(){for(var e,t=this,a=new Date(this.state.year,this.state.month,1),n=new Date(this.state.year,this.state.month+1,0).getDate(),r=1-a.getDay(),i=[];r<=n;){e=[];for(var l=0;l<7;l++)r>=1&&r<=n?e.push(c.a.createElement(Ze,{date:new Date(this.state.year,this.state.month,r)})):e.push(c.a.createElement("div",null)),r++;i.push(e)}return c.a.createElement("div",{className:"row browser_tool"},c.a.createElement("div",{className:"col-12 browser_tool_calendar"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-12 col-md-8 browser_tool_calendar__month_nav"},c.a.createElement("div",{className:"month_nav__arrow month_nav__item",id:"month_nav__last_month",onClick:function(){return t.changeMonth(-1)}},"<<"),c.a.createElement("div",{className:"month_nav__date month_nav__item"},Xe[this.state.month],"  ",this.state.year),c.a.createElement("div",{className:"month_nav__arrow month_nav__item",id:"month_nav__next_month",onClick:function(){return t.changeMonth(1)}},">>")),c.a.createElement("div",{className:"col-12"},c.a.createElement("table",{className:"table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Sun"),c.a.createElement("th",null,"Mon"),c.a.createElement("th",null,"Tue"),c.a.createElement("th",null,"Wed"),c.a.createElement("th",null,"Thu"),c.a.createElement("th",null,"Fri"),c.a.createElement("th",null,"Sat"))),c.a.createElement("tbody",null,i.map((function(e,t){return c.a.createElement("tr",{key:"week_".concat(t.toString())},e.map((function(e){return c.a.createElement("td",{key:Math.random()},e)})))}))))))))}}]),a}(c.a.Component),et=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).downloadDeliverySpreadsheet=function(){console.log("xx");var e="Address line 1\tAddress line 2\tCity\tState\tZip\tName\tEmail Address\tPhone Number\tExternal ID\tOrder Count\tDriver\n",t=[];n.state.orders.forEach((function(a){(t=a.items.filter((function(e){return e.cart_item.delivery_date===W.dateToShortISO(n.props.date)}))).length>0&&(e+="".concat(a.street_address,"\t").concat(a.unit,"\t").concat(a.city,"\tCA\t").concat(a.zip,"\t").concat(a.contact_name,"\t").concat(a.email,"\t").concat(a.phone_number,"\t").concat(a.public_id,"\t").concat(t.length,"\tLee\n"))}));var a=new Blob([e],{type:"text/plain"}),r=document.createElement("a");r.download="delivery_route_".concat(W.dateToShortISO(n.props.date),".tsv"),r.href=window.URL.createObjectURL(a),r.click(),console.log(r)},n.print=function(e){for(var t=[],a=0;a<n.state.orders.length;a++)for(var r=0;r<n.state.orders[a].items.length;r++)n.state.orders[a].items[r].cart_item.delivery_date===W.dateToShortISO(n.props.date)&&t.push(n.state.orders[a].items[r]);switch(e){case"prep":n.props.printDocument(c.a.createElement(nt,{orderItems:t,date:n.props.date}));break;case"delivery_tags":n.props.printDocument(c.a.createElement(at,{orders:n.state.orders,date:n.props.date}))}},n.state={showLoading:!0,orders:[]},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;Pe.retrieveOrders(this.props.dto.window.id,this.props.date).then((function(t){return e.setState({orders:t,showLoading:!1})})).catch((function(e){return window.alert("unable to load data")}))}},{key:"render",value:function(){var e=this;return this.state.showLoading?c.a.createElement(le,null):c.a.createElement("div",{className:"row browser_window_tools mb-2"},c.a.createElement("div",{className:"col-12 browser_window_tools__inner"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},this.props.dto.window.name),c.a.createElement("div",{className:"col-6"},"Deliveries: ",this.props.dto.order_count),c.a.createElement("div",{className:"col-6"},"Dishes: ",this.props.dto.dish_count),c.a.createElement("div",{className:"d-none d-md-block col-md-12 browser_window_tools__controls"},c.a.createElement("button",{className:"btn btn-success",onClick:function(){return e.print("prep")},disabled:0===this.state.orders.length},"print prep list"),c.a.createElement("button",{className:"btn btn-info ml-3",onClick:function(){return e.print("delivery_tags")},disabled:0===this.state.orders.length},"print delivery tags"),c.a.createElement("button",{className:"btn btn-outline-danger ml-3",onClick:function(){return e.props.history.push({pathname:"/dashboard/mail/mass_mailer/upcoming_delivery/".concat(W.dateToShortISO(e.props.date))})},disabled:0===this.state.orders.length},"send mail"),c.a.createElement("button",{className:"btn btn-success ml-3",onClick:this.downloadDeliverySpreadsheet,disabled:0===this.state.orders.length},"download delivery spreadsheet")))))}}]),a}(c.a.Component),tt=Object(p.i)(et),at=function(e){var t=W.dateToShortISO(e.date);return c.a.createElement("div",{className:"delivery_tags"},e.orders.map((function(e){var a=e.items.filter((function(e){return e.cart_item.delivery_date===t}));return c.a.createElement("div",{className:"quarter_print_page",key:"order_".concat(e.id)},c.a.createElement("span",{className:"contact-info"},e.contact_name),c.a.createElement("span",{className:"street-address"},e.street_address," ",e.unit),c.a.createElement("span",{className:"street-address"},e.city," ",e.zip),c.a.createElement("span",{className:"contact-info"},e.phone_number),c.a.createElement("b",null,"Items:"),c.a.createElement("div",{className:"delivery-tag-items"},a.map((function(e){return c.a.createElement("div",{className:"delivery-tag-item",key:"oi_".concat(e.id)},e.cart_item.quantity.toString()+" "+W.extractCartItemDescription(e.cart_item))}))),e.notes&&c.a.createElement("div",{className:"delivery-instructions"},c.a.createElement("br",null),"_______________________________",c.a.createElement("h4",null,"Delivery Instructions:"),c.a.createElement("div",{className:"delivery_instructions_text"},e.notes)))})))},nt=function(e){var t=["No","mild","spicy"],a={},n="",r="",i="",l="",o=0;return e.orderItems.forEach((function(e){r=e.cart_item.menu_item.name,i=e.cart_item.menu_item.proteins.split(":").length>1&&""!==e.cart_item.protein?e.cart_item.protein:"",l=e.cart_item.menu_item.spicy?t[e.cart_item.spicy]:"",(n="".concat(r,":").concat(i,":").concat(l))in a||(a[n]={count:0,dish:r,protein:i,spicy_text:l}),a[n].count+=e.cart_item.quantity,o+=e.cart_item.quantity})),c.a.createElement("div",{className:"prep_list"},c.a.createElement("span",{className:"prep_list__header"},W.dateToShortISO(e.date)," \xa0\xa0:\xa0\xa0",o," items"),c.a.createElement("table",{className:"prep_list__list"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("td",null,"#"),c.a.createElement("td",null,"Dish"),c.a.createElement("td",null,"Protein"),c.a.createElement("td",null,"Spicy"),c.a.createElement("td",null,"L"),c.a.createElement("td",null,"P"))),c.a.createElement("tbody",null,Object.keys(a).sort().map((function(e,t){return c.a.createElement("tr",{className:"".concat(t%2?"":"print-row-dark"),key:e},c.a.createElement("td",null,a[e].count),c.a.createElement("td",null,a[e].dish),c.a.createElement("td",null,a[e].protein),c.a.createElement("td",null,a[e].spicy_text),c.a.createElement("td",null),c.a.createElement("td",null))})))))},rt=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,targetDate:new Date,counts:[],documentToPrint:null},e.printDocument=function(t){e.setState({documentToPrint:t},(function(){return window.print()}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;Pe.listWithCounts(new Date(t.targetDate)).then((function(a){return e.setState({counts:a,targetDate:new Date(t.targetDate)})})).catch((function(e){return console})).then((function(){return e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this;return this.state.loading?c.a.createElement(le,null):c.a.createElement("div",{className:"row browser_full_day justify-content-center"},c.a.createElement("div",{className:"col-12 col-md-7"},c.a.createElement("div",{className:"col-12"},c.a.createElement("button",{onClick:function(){return e.props.history.goBack()}},"return to calendar"),c.a.createElement("div",{className:"col-12 row browser_full_day__date"},W.formatDate(W.dateToShortISO(this.state.targetDate))),c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{className:"row"},this.state.counts.map((function(t){return c.a.createElement("div",{className:"col-12 col-md-6",key:"dto_".concat(t.window.id)},c.a.createElement(tt,{dto:t,date:e.state.targetDate,key:"dto_".concat(t.window.id),printDocument:e.printDocument}))})))))),c.a.createElement("div",{className:"col-12 print-sheet"},this.state.documentToPrint))}}]),a}(c.a.Component),ct=(a(90),function(e){var t=Object(r.useState)(!0),a=Object(te.a)(t,2),n=a[0],i=a[1],l=Object(r.useState)([]),o=Object(te.a)(l,2),s=o[0],d=o[1],m=Object(p.g)();return Object(r.useEffect)((function(){Pe.get().then((function(e){i(!1),d(e)})).catch((function(e){return window.alert("Unable to load delivery windows")}))}),[]),n?c.a.createElement(le,null):c.a.createElement("div",{className:"row delivery_windows"},c.a.createElement("div",{className:"col-12"},c.a.createElement("table",{className:"table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"active"),c.a.createElement("th",null,"name"),c.a.createElement("th",null,"day"),c.a.createElement("th",null,"time"),c.a.createElement("th",null,"date"))),c.a.createElement("tbody",null,s.map((function(e){return c.a.createElement("tr",{key:"dw_".concat(e.id),className:"delivery_windows__window ".concat(e.active?"":"delivery_windows__window-inactive"),onClick:function(){return m.push({pathname:"/dashboard/delivery_window/edit/".concat(e.id)})}},c.a.createElement("td",null,e.active?"yes":"no"),c.a.createElement("td",null,e.name),c.a.createElement("td",null,$e[e.day]),c.a.createElement("td",null,e.start_time+" - "+e.end_time),c.a.createElement("td",null,e.one_off_date))}))))))}),it=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return c.a.createElement("div",{className:"row delivery_window_edit"})}}]),a}(c.a.Component),lt=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={connecting:!0,loggedIn:!1},e.componentDidMount=function(){var t=window.localStorage.getItem("refresh_token");null!==t?A.validateToken(t).then((function(t){e.setState({connecting:!1,loggedIn:!0}),e.props.login(t,"")})).catch((function(t){e.setState({connecting:!1,loggedIn:!1})})):e.setState({connecting:!1,loggedIn:!1})},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;if(this.state.connecting)return c.a.createElement("div",null,"Connecting...");if(!this.props.auth.loggedIn)return c.a.createElement(pe,null);var t=function(t){var a=t.component,n=Object(o.a)(t,["component"]);return c.a.createElement(p.b,Object.assign({},n,{render:function(t){return e.props.auth.loggedIn||e.state.loggedIn?c.a.createElement(a,t):c.a.createElement(p.a,{to:{pathname:"/dashboard/login"}})}}))};return c.a.createElement("div",{className:"container-fluid"},this.props.auth.loggedIn&&c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement(L,null))),c.a.createElement("div",{className:"row app-page"},c.a.createElement("div",{className:"col-12"},c.a.createElement("br",null),c.a.createElement(p.d,null,c.a.createElement(t,{path:"/dashboard/browser/day/:targetDate",component:rt}),c.a.createElement(t,{path:"/dashboard/browser/:month/:year",component:Qe}),c.a.createElement(t,{path:"/dashboard/browser",component:Qe}),c.a.createElement(t,{path:"/dashboard/coupon/add",component:Ce}),c.a.createElement(t,{path:"/dashboard/coupons",component:Se}),c.a.createElement(t,{path:"/dashboard/deliveries",component:q}),c.a.createElement(t,{path:"/dashboard/delivery/edit/:id",component:ee}),c.a.createElement(t,{path:"/dashboard/delivery/duplicate/:id",component:Ie}),c.a.createElement(t,{path:"/dashboard/delivery_window/edit/:id",component:it}),c.a.createElement(t,{path:"/dashboard/delivery_window",component:ct}),c.a.createElement(t,{path:"/dashboard/mail",component:Ve}),c.a.createElement(t,{path:"/dashboard/menu",component:me}),c.a.createElement(t,{path:"/dashboard/newsletter/edit/:id",component:Ye}),c.a.createElement(t,{path:"/dashboard/newsletter",component:Ke}),c.a.createElement(t,{path:"/dashboard/orders/export",component:fe}),c.a.createElement(t,{path:"/dashboard/orders/edit/:id",component:Oe}),c.a.createElement(t,{path:"/dashboard/order/mail/:id",component:Ne}),c.a.createElement(t,{path:"/dashboard/orders",component:ve}),c.a.createElement(t,{path:"/dashboard/",component:He}),c.a.createElement(p.b,{path:"/dashboard/login",component:pe})))))}}]),a}(c.a.Component),ot=Object(v.b)((function(e){return{auth:e.authReducer}}),(function(e){return{login:Object(h.b)(w,e)}}))(lt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(v.a,{store:E},c.a.createElement(T.a,null,c.a.createElement(ot,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[52,1,2]]]);
//# sourceMappingURL=main.14885165.chunk.js.map